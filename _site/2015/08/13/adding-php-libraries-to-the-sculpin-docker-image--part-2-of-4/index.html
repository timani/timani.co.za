<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]-->
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
    Remove this if you use the .htaccess -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Adding PHP libraries to the sculpin docker image - Part 2 of 5</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Mobile viewport optimized: j.mp/bplateviewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory: mathiasbynens.be/notes/touch-icons -->

    <link rel="shortcut icon" href="https://timani.github.io/timani.co.za/images/favicon.png">

    <!-- CSS: implied media="all"
    <link rel="stylesheet" href="https://timani.github.io/timani.co.za/css/style.css">
    -->
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="https://timani.github.io/timani.co.za/img/placeholder.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Material Design Lite">
    <link rel="apple-touch-icon-precomposed" href="images/ios-desktop.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="https://timani.github.io/timani.co.za/images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <!-- More ideas for your <head> here: h5bp.com/docs/#head-Tips -->

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://timani.github.io/timani.co.za/css/material.min.css">
    <link rel="stylesheet" href="https://timani.github.io/timani.co.za/css/custom.css">
    <link rel="stylesheet" href="https://timani.github.io/timani.co.za/css/prism.css">
    <style>
    #view-source {
      position: fixed;
      display: block;
      right: 0;
      bottom: 0;
      margin-right: 40px;
      margin-bottom: 40px;
      z-index: 900;
    }
    </style>
    <!-- All JavaScript at the bottom, except for Modernizr and Respond.
    Modernizr enables HTML5 elements & feature detects; Respond is a polyfill for min/max-width CSS3 Media Queries
    For optimal performance, use a custom Modernizr build: www.modernizr.com/download/ -->
    <script src="https://timani.github.io/timani.co.za/js/libs/modernizr-2.0.min.js"></script>
    <script src="https://timani.github.io/timani.co.za/js/libs/respond.min.js"></script>
  </head>

  <body>

      <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header has-drawer">
                    <div class="mdl-layout__header-row" id="top-nav" style="display: block;text-align: center;">
  
  <div class="mdl-layout__tab-bar-container mdl-color--grey-100">
    <div class="mdl-layout__tab-bar-button mdl-layout__drawer-button mdl-layout__tab-bar-left-button">
      <i class="material-icons">menu</i>
    </div>
    <div class="mdl-layout__tab-bar mdl-js-ripple-effect mdl-color--grey-100 mdl-js-ripple-effect--ignore-events">
      
        <a href="https://timani.github.io/timani.co.za/"  class="mdl-layout__tab ">
          Home
        </a>
    
        <a href="https://timani.github.io/timani.co.za/blog/index.html"  class="mdl-layout__tab ">
          Blog
        </a>
    
        <a href="https://timani.github.io/timani.co.za/archives/index.html"  class="mdl-layout__tab ">
          Archives
        </a>
    
        <a href="https://timani.github.io/timani.co.za/about/index.html"  class="mdl-layout__tab ">
          About
        </a>
    
        <a href="https://timani.github.io/timani.co.za/contact/index.html"  class="mdl-layout__tab ">
          Contact
        </a>
    
      </div>
      <div class="mdl-layout__tab-bar-button mdl-layout__tab-bar-right-button">
        <i class="material-icons">search</i>
      </div>
    </div>
</div>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">Title</span>
    <nav class="mdl-navigation">
      <a class="mdl-navigation__link" href="">Link</a>
      <a class="mdl-navigation__link" href="">Link</a>
      <a class="mdl-navigation__link" href="">Link</a>
      <a class="mdl-navigation__link" href="">Link</a>
    </nav>
  </div>


<a href="#" target="_blank" id="view-source"class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-color--accent mdl-color-text--accent-contrast" data-upgraded=",MaterialButton,MaterialRipple">View Source<span class="mdl-button__ripple-container">
  <span class="mdl-ripple is-animating" ></span></span></a>
      <main  class="demo-main mdl-layout__content">
        <div class="demo-container mdl-grid">
          <div class="mdl-cell mdl-cell--1-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>

          <div class="demo-content mdl-color--white content mdl-color-text--grey-800 mdl-cell mdl-cell--10-col mdl-cell--12-col-tablet mdl-cell--12-col-phone">
              <div class="demo-crumbs mdl-color-text--grey-500">
                <a href="https://timani.github.io/timani.co.za" class="mdl-color-text--grey-500">Home</a> &raquo;
                <a href="https://timani.github.io/timani.co.za/blog/index.html" class="mdl-color-text--grey-500">Blog</a> &raquo; Adding PHP libraries to the sculpin docker image - Part 2 of 5
              </div>
              <article class="h-entry">
              <h3 class="entry-title">Adding PHP libraries to the sculpin docker image - Part 2 of 5</h3>
                <p class="meta-section">
                  <i class="fa fa-clock-o"></i>
  Posted on: <time class="dt-published" datetime="2013-06-13 12:00:00"><span class="tutorial-date">Oct 14, 2013</span></time>
                </p>
                  <p>We most frequently use Curl in the form of <code>libcurl</code>, a C library providing function transferring data between servers using many of the popular protocols like HTTP, FTP, SCP, and so on. This library is the foundation things like all the curl_*() functions in PHP, which are useful for writing code that interacts with various web services.</p>

<!--more-->

<h5 id="summary">Summary</h5>

<p>This is sample project for Test Driven Development (TDD) of Dockerfile by RSpec. This means developing dockerfile by below cycle.</p>

<h6 id="table-of-contents">Table of contents</h6>

<ul>
  <li><a href="#gh-md-toc">Overview</a>
    <ul>
      <li><a href="#local-files">Status and Content</a></li>
    </ul>
  </li>
  <li><a href="#installation">Requirements</a>
    <ul>
      <li><a href="#local-files">Before you begin</a></li>
    </ul>
  </li>
  <li><a href="#table-of-contents">Getting started</a>
    <ul>
      <li><a href="#local-files">Defining Requirements</a></li>
    </ul>
  </li>
  <li><a href="#usage">Tesk Kitchen</a>
    <ul>
      <li><a href="#local-files">Kitchen List</a></li>
      <li><a href="#local-files">Kitchen Converge</a></li>
      <li><a href="#multiple-files">Kichen Verify</a></li>
      <li><a href="#combo">Kitchen Test</a></li>
    </ul>
  </li>
  <li><a href="#tests">Build Docker image</a>
    <ul>
      <li><a href="#local-files">Kitchen List</a></li>
      <li><a href="#local-files">Kitchen Converge</a></li>
      <li><a href="#multiple-files">Kichen Verify</a></li>
      <li><a href="#combo">Kitchen Test</a></li>
    </ul>
  </li>
  <li><a href="#dependency">Conclusion</a></li>
</ul>

<h5 id="overview">Overview</h5>

<p>Allow your teams to use their favorite Agile lifecycle tools while maintaining full visibility and control.
Requirements</p>

<ul>
  <li>Test Driven Development for containers with serverspec</li>
</ul>

<h5 id="getting-started">Getting started</h5>

<ul>
  <li>what this section is about</li>
  <li>
    <p>why it matters
Defining requirements</p>
  </li>
  <li>research or examples</li>
</ul>

<p>Here you can search for any topic that interests you, find information, images, quotes, citations and more, and then quickly insert them into your document.</p>

<table class="mdl-data-table mdl-js-data-table" width="100%">
  <thead>
    <tr>
      <th class="mdl-data-table__cell--non-numeric">Component</th>
      <th class="mdl-data-table__cell--non-numeric">Description</th>
      <th class="mdl-data-table__cell--non-numeric">Type</th>
      <th class="mdl-data-table__cell--non-numeric">Condition</th>
      <th class="mdl-data-table__cell--non-numeric">Criteria</th>
      <th class="mdl-data-table__cell--non-numeric">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class="mdl-data-table__cell--non-numeric">PHP</td>
      <td class="mdl-data-table__cell--non-numeric">php-common</td>
      <td class="mdl-data-table__cell--non-numeric">file</td>
      <td class="mdl-data-table__cell--non-numeric">Should be</td>
      <td class="mdl-data-table__cell--non-numeric">a file</td>
      <td class="mdl-data-table__cell--non-numeric">****</td>
    </tr>
    <tr>
      <td class="mdl-data-table__cell--non-numeric">PHP</td>
      <td class="mdl-data-table__cell--non-numeric">php-iconv</td>
      <td class="mdl-data-table__cell--non-numeric">file</td>
      <td class="mdl-data-table__cell--non-numeric">Should be</td>
      <td class="mdl-data-table__cell--non-numeric">a file</td>
      <td class="mdl-data-table__cell--non-numeric">****</td>
    </tr>
    <tr>
      <td class="mdl-data-table__cell--non-numeric">PHP</td>
      <td class="mdl-data-table__cell--non-numeric">php-phar</td>
      <td class="mdl-data-table__cell--non-numeric">file</td>
      <td class="mdl-data-table__cell--non-numeric">Should be</td>
      <td class="mdl-data-table__cell--non-numeric">a file</td>
      <td class="mdl-data-table__cell--non-numeric">****</td>
    </tr>
    <tr>
      <td class="mdl-data-table__cell--non-numeric">PHP</td>
      <td class="mdl-data-table__cell--non-numeric">php-ctype</td>
      <td class="mdl-data-table__cell--non-numeric">file</td>
      <td class="mdl-data-table__cell--non-numeric">Should be</td>
      <td class="mdl-data-table__cell--non-numeric">a file</td>
      <td class="mdl-data-table__cell--non-numeric">****</td>
    </tr>
    <tr>
      <td class="mdl-data-table__cell--non-numeric">PHP</td>
      <td class="mdl-data-table__cell--non-numeric">php-zip</td>
      <td class="mdl-data-table__cell--non-numeric">file</td>
      <td class="mdl-data-table__cell--non-numeric">Should be</td>
      <td class="mdl-data-table__cell--non-numeric">a file</td>
      <td class="mdl-data-table__cell--non-numeric">****</td>
    </tr>
    <tr>
      <td class="mdl-data-table__cell--non-numeric">PHP</td>
      <td class="mdl-data-table__cell--non-numeric">php-json</td>
      <td class="mdl-data-table__cell--non-numeric">file</td>
      <td class="mdl-data-table__cell--non-numeric">Should be</td>
      <td class="mdl-data-table__cell--non-numeric">a file</td>
      <td class="mdl-data-table__cell--non-numeric">****</td>
    </tr>
  </tbody>
</table>

<p>Table 1: Docker PHP requirements
- takeaways
##### Building the docker image</p>

<ul>
  <li>what this section is about</li>
  <li>why it matters</li>
  <li>research or examples</li>
</ul>

<p>Create a Dockerfile and add it to the repository with the following contents. This will install ruby as well as bundler so we can add the gems for bootstrap and start working on the theme:</p>

<pre><code class="language-docker">FROM centos:7
MAINTAINER timani tunduwani

# Install Remi Collet's repo for CentOS 7
RUN yum -y install \
  http://rpms.famillecollet.com/enterprise/remi-release-7.rpm

# Install PHP and Percona (MySQL) client stuff and the latest stable PHP.
RUN yum -y install --enablerepo=remi,remi-php56 \
  httpd php php-gd php-xml php-zip pwgen psmisc tar git zip

RUN yum -y update &amp;&amp; yum clean all

# Add Composer
RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
# Install Sculpin
RUN curl -O https://download.sculpin.io/sculpin.phar; chmod +x sculpin.phar; mv sculpin.phar /usr/local/bin/sculpin
# Expose the port for the sculpin server
EXPOSE 8000
# Move to the directory were the sculpin PHP files will be located
WORKDIR /var/www
COPY ./run.sh /var/www/
CMD bash /var/www/run.sh
</code></pre>

<p>Updated project directory with the new Docker tests</p>

<pre><code class="language-bash">├── .gitignore
├── .rspec
├── Dockerfile
├── Gemfile
├── Rakefile
└── specs/
</code></pre>

<ul>
  <li>takeaways</li>
</ul>

<h5 id="build-docker-image-and-run-test---green">Build Docker image and run test -&gt; <code>GREEN</code></h5>

<ul>
  <li>what this section is about</li>
  <li>why it matters</li>
  <li>research or examples</li>
</ul>

<p>Running the first serverspec tests</p>
<pre><code class="language-bash">$ rspec spec/Dockerfile_spec.rb
1 example, 3 failures
</code></pre>

<p>Excellent, 3 success messages just as we had hoped. The reason is because our docker image has met all of the dependencies based on the requirements</p>

<ul>
  <li>takeaways</li>
</ul>

<p>Now with our updated.</p>
<pre><code data-language="shell">
├── app
│   └── config
├── composer.json
├── Dockerfile
├── LICENSE
├── publish.sh
├── README.md
├── run.sh
├── s3.conf.dist
├── s3-publish.sh
├── sculpin.json
├── sculpin.lock
└── source
    ├── 404.html
    ├── ...
</code></pre>

<h6 id="step-2-start-the-sculpin-container">Step 2: Start the sculpin container</h6>

<p>Install ruby and the bundler gem so it is available within the container.</p>
<pre><code data-language="shell">
# Build the local docker image
docker build .

# List the available images
docker images

# Create a sculpin container
# `-v`: within the host machine within the container so sculpin can be built in
#       the container and previewed on the host machine.
# `-p`: Expose the port `8000`  within the host machine and the container.
# `timani/sculpin`: The command that will be executed when the container build
        process is complete.
# `/bin/run.sh`: The command that will be executed when the container build
        process is complete.
docker run  -v ./:/var/www/ -p 8000:8000 timani/sculpin /bash
</code></pre>

<p>We can quickly test the new container by going to the URL that is returned. The docker logs command allows us to see output from within the STDOUT of the container.</p>

<h6 id="step-3-list-the-currently-running-container">Step 3: List the currently running container</h6>
<pre><code data-language="shell">
docker ps

# Output the logs from the Sculpin container
docker logs
</code></pre>

<p>This will allow us to read the output of STDOUT from the container so we keep track of the composer install and sculpin site generation process. When the installation process is complete, you can check out the new site.</p>

<h5 id="previewing-the-sculpin-site">Previewing the Sculpin site</h5>

<ul>
  <li>what this section is about</li>
  <li>why it matters</li>
  <li>research or examples</li>
</ul>

<p>Next we use the docker run command to set up a container that will come bundled with PHP, Composer and sculpin ready to go.</p>

<p><img src="https://www.evernote.com/shard/s389/sh/a7b0da9b-ed77-4ed2-a7fd-1a08168be31a/49be0473012d50347c8c8cec5b8ca0bd/res/432689fc-0b9b-431d-b9a5-efc8ffd78536/.jpg" width="100%" /></p>

<ul>
  <li>takeaways</li>
</ul>

<h5 id="create-post">Create post</h5>

<p><img src="https://asciinema.org/a/624fjx2rx7k3pctdozw7m8b24.png" width="100%" /></p>

<h5 id="conclusion">Conclusion</h5>

<p>Use composer to download and manage the dependencies for the project. When that is done, we can proceed to install sculpin and generate the project.</p>

<h5 id="whats-next">What’s next?</h5>

<p>Use the Research tool’s dictionary to search for definitions, synonyms, and usage examples. If you don’t already have the Research tool open, you can access the dictionary by clicking the Tools menu and then selecting Define.</p>


                  <div class="mdl-grid" style="border-top: 1px solid #efefef;border-bottom: 1px solid #efefef;">
                  <div class="mdl-cell mdl-cell--6-col mdl-cell--4-col-tablet mdl-cell--12-col-phone">
                    <div class="" style="">
                        <h6>&laquo; Prev</h6>
                          <a class="url fn" href="https://timani.co.za">Publishing a docker image and automating tests with travisci - Part 3 of 4</a>
                  <div class="adr"> <span class="country-name">Posted on Oct 14th, 2015</span></div>
                  Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu. Duis nulla tempor do aute et eiusmod velit exercitation nostrud quis <a href="#">proident minim</a></div></div>
  <div class="mdl-cell mdl-cell--6-col mdl-cell--4-col-tablet mdl-cell--12-col-phone" style="


"><div class="" style="">
  <h6>Next &raquo;</h6>
                  <a class="url fn" href="https://timani.co.za">Using minimal Sculpin docker image to developing static sites - Part 2 of 4</a>
                  <div class="adr"> <span class="country-name">Posted on Nov 29th, 2015</span></div>
                  Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu. Duis nulla tempor do aute et eiusmod velit exercitation nostrud quis <a href="#">proident minim</a></div></div>
</div>
              </article>
              <div class="mdl-grid mdl-grid--no-spacing vcard mdl-shadow--2dp" id="hcard-Timani-Tunduwani">
                <div class="section__circle-container mdl-cell mdl-cell--2-col mdl-cell--1-col-phone">
                  <div class="section__circle-container__circle"><img src="http://www.gravatar.com/avatar/bac5f46541d2e394355c0f46a03d81ff.jpg?s=200" alt="photo of " class="photo" width="85%" style="
    padding: 20px;"></div>
                </div>
                <div class="section__text mdl-cell mdl-cell--9-col-desktop mdl-cell--6-col-tablet mdl-cell--3-col-phone" style="
    padding: 35px;
">
                  <a class="url fn" href="https://timani.co.za">Timani Tunduwani</a>
                  <div class="adr"> <span class="country-name">United States</span></div>
                  Dolore ex deserunt aute fugiat aute nulla ea sunt aliqua nisi cupidatat eu.
                  Duis nulla tempor do aute et eiusmod velit exercitation nostrud quis
                  </div>

              <div class="mdl-card__actions mdl-card--border">
                  <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
                    Read more &raquo;
                  </a>
              </div>    </div>


              <div id="disqus_thread"></div>
                  <script type="text/javascript">
                      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                      var disqus_shortname = 'timani'  ; // required: replace example with your forum shortname
                      // var disqus_developer = 1; // Comment out when the site is live
                      var disqus_identifier = "/2015/08/13/adding-php-libraries-to-the-sculpin-docker-image--part-2-of-4/";

                      /* * * DON'T EDIT BELOW THIS LINE * * */
                      (function() {
                          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                      })();
                  </script>
                  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                </div>
            </div>
      </main>

    <footer class="demo-footer mdl-mini-footer">
  <div class="mdl-mini-footer--left-section">
    <ul class="mdl-mini-footer--link-list">
      <li><a href="#">Help</a></li>
      <li><a href="#">Privacy and Terms</a></li>
      <li><a href="#">User Agreement</a></li>
    </ul>
  </div>
</footer>



    <div id="container">  </div> <!--! end of #container -->
<!-- JavaScript at the bottom for fast page loading -->

<!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.6.2.min.js"><\/script>')</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.3.0/anchor.min.js"></script>

<script src="https://timani.github.io/timani.co.za/js/prism.js"></script>
<!-- scripts concatenated and minified via ant build script-->
<script src="https://timani.github.io/timani.co.za/js/plugins.js"></script>
<script src="https://timani.github.io/timani.co.za/js/script.js"></script>

<!-- Material Design JS-->
<script src="https://storage.googleapis.com/code.getmdl.io/1.0.6/material.min.js"></script>

<!-- you can create a custom build with specific languages this should go before the closing </body> -->


<!-- end scripts-->

<!-- mathiasbynens.be/notes/async-analytics-snippet Change UA-XXXXX-X to be your site's ID
<script>
  var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview'],['_trackPageLoadTime']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script> -->

<!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.
     chromium.org/developers/how-tos/chrome-frame-getting-started -->
<!--[if lt IE 7 ]>
  <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
  <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
<![endif]-->
</body>
</html>
